<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8"/>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
		<meta name="HandheldFriendly" content="true"/>
		<meta name="MobileOptimized" content="320"/>
		<title>Hello H5+</title>
		<script src="js/zepto.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/touch.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/template.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" charset="utf-8">
var ws=null;
var list=null;

function plusReady(){

		
	}
// 判断扩展API是否准备，否则监听"plusready"事件


$(function(){
	if(window.plus){
		ADDR.init();
	}else{
		document.addEventListener("plusready",function(){ADDR.init();},false);
	}
})

var ADDR = {
	init:function(){
		this.map = null;
		$('#map').on('click',function(){
					alert(111)
				})
		this.userLocation();
	},
	
	m2l:function(){
		var x = m.x/20037508.34*180;
		var y = m.y/20037508.34*180;
		y = 180/Math.PI*(2*Math.atan(Math.exp(y*Math.PI/180))-Math.PI/2);
		return {
		    x:x,
		    y:y
		}
	},
	
	dis:function(a,b){
		return Math.sqrt((a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y));
	},
	
	renderMap:function(){
		this.map.centerAndZoom(this.mypos,16);
		var circle = new plus.maps.Circle();
		circle.setCenter(this.mypos);
		circle.setRadius(5000);
		circle.setLineWidth(2);
		circle.setStrokeColor("#111111");
		circle.setFillColor('#0000ff');
		circle.setFillOpacity(0.1)
		this.map.addOverlay(circle);
		//this.createMarker();
	},
	
	
	
	createMarker:function(){
		var marker=new plus.maps.Marker(new plus.maps.Point(116.3977,39.906016));
		marker.setIcon("img/avatar_bianji.png");
		marker.setLabel("HBuilder");
		var bubble = new plus.maps.Bubble("打造最好的HTML5移动开发工具");
		marker.setBubble(bubble);
		this.map.addOverlay(marker);
	},
									
	userLocation: function(){
		this.map=new plus.maps.Map("map");
		this.map.setZoom(14);
		console.log(this.map)
		this.map.showUserLocation( true );
		this.map.getUserLocation(function(state,pos){
			if(0==state){
				ADDR.mypos = pos
				ADDR.renderMap();
			}
		});
	}
	
	
}


</script>
		<link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8"/>
		<style type="text/css">
#map{width:100%;height:100%;}
.clearfix:after {
  content: " ";
  display: block;
  clear: both;
  height: 0;
}
.clearfix {
  zoom: 1;
}
#tools{
	position: fixed;
	top:50px;
	height: 100px;
	width: 100px;
	z-index: 999999999999;
}
		</style>
	</head>
	<body>
		
		<div id="map">地图加载中...</div>
		
	</body>
</html>